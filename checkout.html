<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><title>Checkout</title><script>window.SQUARE_APPLICATION_ID=window.SQUARE_APPLICATION_ID||'YOUR_APP_ID';window.SQUARE_LOCATION_ID=window.SQUARE_LOCATION_ID||'YOUR_LOCATION_ID';window.API_BASE=window.API_BASE||'https://YOUR-VERCEL-APP.vercel.app';</script><script src='https://sandbox.web.squarecdn.com/v1/square.js'></script></head><body><div id='card-container'></div><button id='pay'>Pay</button><div id='error'></div><script>async function qs(n){return new URLSearchParams(location.search).get(n)}const variationId=qs('variationId'),quantity=Math.max(1,parseInt(qs('quantity')||'1',10)),mods=(qs('mods')||'').split(',').map(s=>s.trim()).filter(Boolean),note=qs('note')||'';async function main(){if(!window.Square){document.getElementById('error').textContent='Square SDK failed to load';return}const p=Square.payments(window.SQUARE_APPLICATION_ID,window.SQUARE_LOCATION_ID);const card=await p.card();await card.attach('#card-container');document.getElementById('pay').addEventListener('click',async()=>{document.getElementById('pay').disabled=!0;document.getElementById('error').textContent='';try{const t=await card.tokenize();if(t.status!=='OK')throw new Error(t.errors?.[0]?.message||'Tokenize failed');const body={variationId,quantity,token:t.token,modifiers:mods.map(id=>({catalogObjectId:id})),note};const r=await fetch((window.API_BASE||'')+'/api/checkout',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});const j=await r.json();if(!r.ok)throw new Error(j.error||'Payment failed');location.href='thank-you.html'}catch(e){document.getElementById('error').textContent=e.message||'Error';document.getElementById('pay').disabled=!1}})}main();</script><script src='assets/nav-cart.js' defer></script></body></html>